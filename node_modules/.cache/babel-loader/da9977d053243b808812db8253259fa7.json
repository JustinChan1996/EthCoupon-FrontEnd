{"ast":null,"code":"var _jsxFileName = \"/Volumes/Data/BlockchainCourse/FrontEnd/ethcoupon-finalproject-react/src/myCoupon.js\";\nimport React, { Component } from 'react';\nimport logo from \"./logo.svg\";\nimport './App.css';\nimport Web3 from 'web3';\nimport { NavLink } from \"react-router-dom\";\nimport { ADDRESS, ABI } from './ABI'; // import { Web3ReactProvider } from '@web3-react/core'\n// import { Web3Provider } from '@ethersproject/providers'\n// import { useWeb3React } from '@web3-react/core'\n// import { InjectedConnector } from '@web3-react/injected-connector'\n\nimport { hello, getRedeemCouponInfo, getRedeem } from './helper';\nimport RedeemTable from './RedeemTable';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass MyCoupon extends React.Component {\n  componentDidMount() {\n    this.loadBlockchainData();\n    this.toStorePromoCode = this.toStorePromoCode.bind(this);\n    this.RedeemPromotion = this.RedeemPromotion.bind(this);\n  }\n\n  async loadBlockchainData() {\n    const web3 = new Web3(Web3.givenProvider);\n    const chainId = await web3.eth.getChainId();\n    console.log(chainId);\n    this.setState({\n      accountInfo: ''\n    });\n    var contractInstance = new web3.eth.Contract(ABI, ADDRESS);\n    const accounts = await web3.eth.getAccounts(); // await GetAllPromoCodes(contractInstance);\n\n    var that = this;\n    var redeems = []; // redeems = await getRedeem(contractInstance,accounts[0]);\n\n    redeems = await getRedeemCouponInfo(contractInstance, accounts[0]);\n    console.log(redeems);\n  }\n\n  async RedeemPromotion() {\n    const web3 = new Web3(Web3.givenProvider);\n    const accounts = await web3.eth.getAccounts();\n    var contractInstance = new web3.eth.Contract(ABI, ADDRESS);\n    console.log(accounts[0]);\n    contractInstance.methods.redeem(this.state.promoCode).send({\n      from: accounts[0]\n    }).on(\"transactionHash\", function (hash) {\n      alert('success'); // $('#myModal').modal('hide');\n    }).on(\"error\", function (error) {\n      alert(error);\n    });\n  }\n\n  toStorePromoCode(event) {\n    this.setState({\n      promoCode: event.target.value\n    });\n    console.log(event.target.value);\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      promoCode: ''\n    };\n  }\n\n  render() {\n    const header = [\"Promotion Code\", \"Date Redeemed\", \"Target account\", \"Starting Date\", \"Ending Date\", \"Redeemed Ether\", \"Min Coupon Txn Amount\", \"Max coupon txn amount\"];\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      class: \"container mt-5\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            textAlign: 'right'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            style: {\n              float: 'right'\n            },\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  class: \"form-control\",\n                  name: \"txtPromoCode\",\n                  id: \"txtPromoCode\",\n                  value: this.state.promoCode,\n                  onChange: this.toStorePromoCode\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 81,\n                  columnNumber: 29\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 81,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  class: \"btn btn-success\",\n                  onClick: this.RedeemPromotion,\n                  id: \"btn_RedeemPromotion\",\n                  children: \"Redeem Coupon\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 81,\n                  columnNumber: 180\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 81,\n                columnNumber: 176\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 80,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n          children: \"My coupons\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(RedeemTable, {\n          header: header\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 9\n    }, this);\n  }\n\n}\n\nexport default MyCoupon;","map":{"version":3,"sources":["/Volumes/Data/BlockchainCourse/FrontEnd/ethcoupon-finalproject-react/src/myCoupon.js"],"names":["React","Component","Web3","NavLink","ADDRESS","ABI","hello","getRedeemCouponInfo","getRedeem","RedeemTable","MyCoupon","componentDidMount","loadBlockchainData","toStorePromoCode","bind","RedeemPromotion","web3","givenProvider","chainId","eth","getChainId","console","log","setState","accountInfo","contractInstance","Contract","accounts","getAccounts","that","redeems","methods","redeem","state","promoCode","send","from","on","hash","alert","error","event","target","value","constructor","props","render","header","textAlign","float"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;;AAEA,OAAO,WAAP;AACA,OAAOC,IAAP,MAAiB,MAAjB;AACA,SAASC,OAAT,QAAwB,kBAAxB;AACA,SAAQC,OAAR,EAAiBC,GAAjB,QAA2B,OAA3B,C,CACA;AACA;AACA;AACA;;AACA,SAAQC,KAAR,EAAcC,mBAAd,EAAkCC,SAAlC,QAAkD,UAAlD;AACA,OAAOC,WAAP,MAAwB,eAAxB;;;AAGA,MAAMC,QAAN,SAAuBV,KAAK,CAACC,SAA7B,CAAwC;AAEpCU,EAAAA,iBAAiB,GAAG;AAChB,SAAKC,kBAAL;AACA,SAAKC,gBAAL,GAAwB,KAAKA,gBAAL,CAAsBC,IAAtB,CAA2B,IAA3B,CAAxB;AACA,SAAKC,eAAL,GAAuB,KAAKA,eAAL,CAAqBD,IAArB,CAA0B,IAA1B,CAAvB;AAGD;;AAEuB,QAAlBF,kBAAkB,GAAE;AACxB,UAAMI,IAAI,GAAG,IAAId,IAAJ,CAASA,IAAI,CAACe,aAAd,CAAb;AACA,UAAMC,OAAO,GAAG,MAAMF,IAAI,CAACG,GAAL,CAASC,UAAT,EAAtB;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAYJ,OAAZ;AACA,SAAKK,QAAL,CAAc;AAACC,MAAAA,WAAW,EAAE;AAAd,KAAd;AACA,QAAIC,gBAAgB,GAAG,IAAIT,IAAI,CAACG,GAAL,CAASO,QAAb,CAAsBrB,GAAtB,EAA2BD,OAA3B,CAAvB;AACA,UAAMuB,QAAQ,GAAG,MAAMX,IAAI,CAACG,GAAL,CAASS,WAAT,EAAvB,CANwB,CAOxB;;AAEA,QAAIC,IAAI,GAAG,IAAX;AACA,QAAIC,OAAO,GAAG,EAAd,CAVwB,CAYxB;;AACAA,IAAAA,OAAO,GAAG,MAAMvB,mBAAmB,CAACkB,gBAAD,EAAkBE,QAAQ,CAAC,CAAD,CAA1B,CAAnC;AACAN,IAAAA,OAAO,CAACC,GAAR,CAAYQ,OAAZ;AAED;;AAEkB,QAAff,eAAe,GAAE;AACnB,UAAMC,IAAI,GAAG,IAAId,IAAJ,CAASA,IAAI,CAACe,aAAd,CAAb;AACA,UAAMU,QAAQ,GAAG,MAAMX,IAAI,CAACG,GAAL,CAASS,WAAT,EAAvB;AACA,QAAIH,gBAAgB,GAAG,IAAIT,IAAI,CAACG,GAAL,CAASO,QAAb,CAAsBrB,GAAtB,EAA2BD,OAA3B,CAAvB;AACAiB,IAAAA,OAAO,CAACC,GAAR,CAAYK,QAAQ,CAAC,CAAD,CAApB;AAEAF,IAAAA,gBAAgB,CAACM,OAAjB,CAAyBC,MAAzB,CAAgC,KAAKC,KAAL,CAAWC,SAA3C,EAAsDC,IAAtD,CAA2D;AAACC,MAAAA,IAAI,EAAET,QAAQ,CAAC,CAAD;AAAf,KAA3D,EACCU,EADD,CACI,iBADJ,EACsB,UAASC,IAAT,EAAc;AAChCC,MAAAA,KAAK,CAAC,SAAD,CAAL,CADgC,CAEhC;AACH,KAJD,EAKCF,EALD,CAKI,OALJ,EAKa,UAASG,KAAT,EAAe;AACxBD,MAAAA,KAAK,CAACC,KAAD,CAAL;AACH,KAPD;AASD;;AAED3B,EAAAA,gBAAgB,CAAC4B,KAAD,EAAO;AACrB,SAAKlB,QAAL,CAAc;AAACW,MAAAA,SAAS,EAAEO,KAAK,CAACC,MAAN,CAAaC;AAAzB,KAAd;AACAtB,IAAAA,OAAO,CAACC,GAAR,CAAYmB,KAAK,CAACC,MAAN,CAAaC,KAAzB;AACD;;AAEDC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;AACA,SAAKZ,KAAL,GAAa;AAACC,MAAAA,SAAS,EAAE;AAAZ,KAAb;AACD;;AAEHY,EAAAA,MAAM,GAAE;AAEJ,UAAMC,MAAM,GAAG,CAAC,gBAAD,EAAkB,eAAlB,EAAkC,gBAAlC,EAAmD,eAAnD,EAAmE,aAAnE,EAAiF,gBAAjF,EAAkG,uBAAlG,EAA0H,uBAA1H,CAAf;AAEA,wBAEA;AAAK,MAAA,KAAK,EAAC,gBAAX;AAAA,6BACA;AAAK,QAAA,KAAK,EAAC,KAAX;AAAA,gCACI;AAAK,UAAA,KAAK,EAAE;AAACC,YAAAA,SAAS,EAAC;AAAX,WAAZ;AAAA,iCACI;AAAO,YAAA,KAAK,EAAE;AAACC,cAAAA,KAAK,EAAC;AAAP,aAAd;AAAA,mCACI;AAAA,sCACI;AAAA,uCAAI;AAAO,kBAAA,IAAI,EAAC,MAAZ;AAAmB,kBAAA,KAAK,EAAC,cAAzB;AAAwC,kBAAA,IAAI,EAAC,cAA7C;AAA4D,kBAAA,EAAE,EAAC,cAA/D;AAA8E,kBAAA,KAAK,EAAE,KAAKhB,KAAL,CAAWC,SAAhG;AAA2G,kBAAA,QAAQ,EAAE,KAAKrB;AAA1H;AAAA;AAAA;AAAA;AAAA;AAAJ;AAAA;AAAA;AAAA;AAAA,sBADJ,eAC2J;AAAA,uCAAI;AAAQ,kBAAA,IAAI,EAAC,QAAb;AAAsB,kBAAA,KAAK,EAAC,iBAA5B;AAA8C,kBAAA,OAAO,EAAE,KAAKE,eAA5D;AAA6E,kBAAA,EAAE,EAAC,qBAAhF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAJ;AAAA;AAAA;AAAA;AAAA,sBAD3J;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBADJ,eAQI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBARJ,eASI;AAAA;AAAA;AAAA;AAAA,gBATJ,eAUI;AAAA;AAAA;AAAA;AAAA,gBAVJ,eAWI;AAAA;AAAA;AAAA;AAAA,gBAXJ,eA0CA,QAAC,WAAD;AAAa,UAAA,MAAM,EAAEgC;AAArB;AAAA;AAAA;AAAA;AAAA,gBA1CA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA,YAFA;AAkDH;;AA7GmC;;AAgHxC,eAAerC,QAAf","sourcesContent":["import React, { Component } from 'react'\nimport logo from './logo.svg'\nimport './App.css'\nimport Web3 from 'web3'\nimport { NavLink } from \"react-router-dom\";\nimport {ADDRESS, ABI} from './ABI'\n// import { Web3ReactProvider } from '@web3-react/core'\n// import { Web3Provider } from '@ethersproject/providers'\n// import { useWeb3React } from '@web3-react/core'\n// import { InjectedConnector } from '@web3-react/injected-connector'\nimport {hello,getRedeemCouponInfo,getRedeem} from './helper';\nimport RedeemTable from './RedeemTable';\n\n\nclass MyCoupon extends React.Component  {\n\n    componentDidMount() {\n        this.loadBlockchainData();\n        this.toStorePromoCode = this.toStorePromoCode.bind(this);\n        this.RedeemPromotion = this.RedeemPromotion.bind(this);\n        \n\n      }\n\n      async loadBlockchainData(){\n        const web3 = new Web3(Web3.givenProvider);\n        const chainId = await web3.eth.getChainId();\n        console.log(chainId);\n        this.setState({accountInfo: ''});\n        var contractInstance = new web3.eth.Contract(ABI, ADDRESS);\n        const accounts = await web3.eth.getAccounts();\n        // await GetAllPromoCodes(contractInstance);\n    \n        var that = this;\n        var redeems = [];\n    \n        // redeems = await getRedeem(contractInstance,accounts[0]);\n        redeems = await getRedeemCouponInfo(contractInstance,accounts[0]);\n        console.log(redeems);\n    \n      }\n\n    async RedeemPromotion(){\n        const web3 = new Web3(Web3.givenProvider);\n        const accounts = await web3.eth.getAccounts();\n        var contractInstance = new web3.eth.Contract(ABI, ADDRESS);\n        console.log(accounts[0]);\n\n        contractInstance.methods.redeem(this.state.promoCode).send({from: accounts[0]})\n        .on(\"transactionHash\",function(hash){\n            alert('success');\n            // $('#myModal').modal('hide');\n        })\n        .on(\"error\", function(error){\n            alert(error);\n        });\n\n      }\n\n      toStorePromoCode(event){\n        this.setState({promoCode: event.target.value});\n        console.log(event.target.value);\n      }\n\n      constructor(props) {\n        super(props)\n        this.state = {promoCode: ''};\n      }\n\n    render(){\n\n        const header = [\"Promotion Code\",\"Date Redeemed\",\"Target account\",\"Starting Date\",\"Ending Date\",\"Redeemed Ether\",\"Min Coupon Txn Amount\",\"Max coupon txn amount\"]\n\n        return (\n            \n        <div class=\"container mt-5\">\n        <div class=\"row\">\n            <div style={{textAlign:'right'}}>\n                <table style={{float:'right'}}>\n                    <tr>\n                        <td><input type=\"text\" class=\"form-control\" name=\"txtPromoCode\" id=\"txtPromoCode\" value={this.state.promoCode} onChange={this.toStorePromoCode} /></td><td><button type=\"button\" class=\"btn btn-success\" onClick={this.RedeemPromotion} id=\"btn_RedeemPromotion\">Redeem Coupon</button></td>\n                    </tr>\n                </table>\n            </div>\n            <h5>My coupons</h5>\n            <hr/>\n            <br/>\n            <br/>\n            {/* <table class=\"table table-striped\">\n            <thead>\n            <tr>\n                <th></th>\n                <th>Promotion Code</th>\n                <th>Date Redemmed</th>\n                <th>Target account</th>\n                <th>Ether balance</th>\n                <th>Starting Date</th>\n                <th>Ending Date</th>\n                <th>Redemmed Ether</th>\n                <th>Min Coupon Txn Amount</th>\n                <th>Max Coupon Txn Amount</th>\n            </tr>\n            </thead>\n            <tbody>\n            <tr>\n                <th><i class=\"fa fa-credit-card\"></i></th>\n                <td>Ethereum</td>\n                <td>01/12/2021</td>\n                <td>0x28cd15e5B23a8bA95Bb4660c3d305Fb18081c517</td>\n                <td>0.6</td>\n                <td>15/01/2022</td>\n                <td>20/01/2022</td>\n                <td>2</td>\n                <td>0.1</td>\n                <td>0.5</td>\n            </tr>\n            </tbody>\n        </table> */}\n        <RedeemTable header={header}/>\n        </div>\n        </div>\n\n        );\n    }\n}\n\nexport default MyCoupon;\n"]},"metadata":{},"sourceType":"module"}