{"ast":null,"code":"import Web3 from 'web3';\nexport function hello() {\n  alert('hello');\n}\nexport function getPromotion(contractInstance, account) {\n  return new Promise(function (resolve, reject) {\n    var codeArray = [];\n    contractInstance.getPastEvents('Promotion', {\n      filter: {\n        sponsorAddress: account\n      },\n      // Using an array means OR: e.g. 20 or 23\n      fromBlock: 0,\n      toBlock: 'latest'\n    }, function (error, events) {\n      console.log(events);\n\n      if (events.length > 0) {\n        // console.log(events[0].returnValues); \n        for (var i = 0; i < events.length; i++) {\n          // Get promotional balance for all of them\n          // console.log(events[i].returnValues[\"couponCode\"]);\n          // var res = await GetPromotionBalance(contractInstance,account,events[i].returnValues[\"couponCode\"]);\n          // console.log(\"Balance is \" + res.leftOver);\n          // events[i].returnValues.Balance = res.leftOver;\n          // events[i].returnValues.unspentEther = res.unspentEther;\n          // console.log(events[i].returnValues);\n          codeArray.push(events[i].returnValues); // codeArray.push([events[i].returnValues.couponCode,events[i].returnValues.sponsorAddress,new Date(events[i].returnValues.dateCreated*1000),events[i].returnValues.targetAddress,Web3.utils.fromWei(events[i].returnValues.totalEth,\"ether\"),Web3.utils.fromWei(events[i].returnValues.amtPerAddress,\"ether\"),Web3.utils.fromWei(events[i].returnValues.minRedeemAmt,\"ether\"),Web3.utils.fromWei(events[i].returnValues.maxRedeemAmt,\"ether\"),new Date(events[i].returnValues.startDate*1000),new Date(events[i].returnValues.endDate*1000)]);\n        }\n\n        resolve(codeArray);\n      }\n    }).then(function (events) {});\n  });\n}\nexport function getPromotionForCouponHash(contractInstance, hash) {\n  return new Promise(function (resolve, reject) {\n    var codeArray = [];\n    contractInstance.getPastEvents('Promotion', {\n      filter: {\n        couponHash: hash\n      },\n      // Using an array means OR: e.g. 20 or 23\n      fromBlock: 0,\n      toBlock: 'latest'\n    }, function (error, events) {\n      console.log(events);\n\n      if (events.length > 0) {\n        // console.log(events[0].returnValues); \n        // for(var i=0;i<events.length;i++){\n        codeArray.push(events[0].returnValues); // }\n\n        resolve(codeArray);\n      }\n    }).then(function (events) {});\n  });\n}\nexport function getRedeem(contractInstance, account) {\n  return new Promise(function (resolve, reject) {\n    var codeArray = [];\n    contractInstance.getPastEvents('Redeem', {\n      filter: {\n        user: account\n      },\n      // Using an array means OR: e.g. 20 or 23\n      fromBlock: 0,\n      toBlock: 'latest'\n    }, function (error, events) {\n      console.log(events);\n\n      if (events.length > 0) {\n        // console.log(events[0].returnValues);\n        for (var i = 0; i < events.length; i++) {\n          codeArray.push(events[i].returnValues);\n        }\n\n        resolve(codeArray);\n      }\n    }).then(function (events) {});\n  });\n}\nexport async function getRedeemCouponInfo(contractInstance, account) {\n  // return new Promise(function(resolve, reject) {\n  var redeems = await getRedeem(contractInstance, account);\n\n  for (var i = 0; i < redeems.length; i++) {\n    var couponInfo = await getPromotionForCouponHash(contractInstance, redeems[i][0]); // append promotion code,target account, starting date, ending date, amount redemmed, min coupon txn amount and max coupon txn amount\n\n    console.log(couponInfo);\n\n    if (couponInfo.length > 0) {\n      redeems[i][\"couponCode\"] = couponInfo[0].couponCode;\n      redeems[i][\"startDate\"] = couponInfo[0].startDate;\n      redeems[i][\"endDate\"] = couponInfo[0].endDate;\n      redeems[i][\"endDate\"] = couponInfo[0].endDate;\n      redeems[i][\"amtPerAddress\"] = couponInfo[0].amtPerAddress;\n      redeems[i][\"minRedeemAmt\"] = couponInfo[0].minRedeemAmt;\n      redeems[i][\"maxRedeemAmt\"] = couponInfo[0].maxRedeemAmt;\n      redeems[i][\"targetAddress\"] = couponInfo[0].targetAddress;\n    }\n  }\n\n  return redeems;\n}\nexport function GetPromotionBalance(contractInstance, account, promoCode) {\n  return new Promise(function (resolve, reject) {\n    // var details = await contractInstance.checkPromotionalBalance.call(promoCode,{from: account});\n    // console.log(details);\n    // // return resolve(details);\n    // return details;\n    contractInstance.methods.checkPromotionalBalance(promoCode).call({\n      from: account\n    }).then(function (result) {\n      console.log(result);\n      return resolve(result);\n    });\n  });\n}\n_c = GetPromotionBalance;\nexport function GetCouponBalance(contractInstance, account, promoCode) {\n  return new Promise(function (resolve, reject) {\n    // var details = await contractInstance.checkPromotionalBalance.call(promoCode,{from: account});\n    // console.log(details);\n    // // return resolve(details);\n    // return details;\n    contractInstance.methods.checkCouponBalance(promoCode).call({\n      from: account\n    }).then(function (result) {\n      console.log(result);\n      return resolve(result);\n    });\n  });\n}\n_c2 = GetCouponBalance;\nexport async function getPromotionWithBalances(contractInstance, account) {\n  var promoList = await getPromotion(contractInstance, account);\n\n  for (var i = 0; i < promoList.length; i++) {\n    console.log(\"Promotion code is \" + promoList[i][\"couponCode\"]);\n    var res = await GetPromotionBalance(contractInstance, account, promoList[i][\"couponCode\"]); // append promotion code,target account, starting date, ending date, amount redemmed, min coupon txn amount and max coupon txn amount\n\n    console.log(\"Coupon \" + promoList[i][\"couponCode\"] + \" still has \" + res.leftOver); // if(res.length > 0){\n\n    promoList[i][\"Balance\"] = res.leftOver;\n    promoList[i][\"unspentEther\"] = res.unspentEther; // }\n  }\n\n  return promoList;\n}\nexport async function getCouponWithBalance(contractInstance, account) {\n  var couponList = await getRedeemCouponInfo(contractInstance, account);\n\n  for (var i = 0; i < couponList.length; i++) {\n    console.log(\"Coupon code is \" + couponList[i][\"couponCode\"]);\n    var res = await GetCouponBalance(contractInstance, account, couponList[i][\"couponCode\"]); // append promotion code,target account, starting date, ending date, amount redemmed, min coupon txn amount and max coupon txn amount\n\n    console.log(\"Coupon \" + couponList[i][\"couponCode\"] + \" still has \" + res); // if(res.length > 0){\n\n    couponList[i][\"Balance\"] = res.leftOver; // }    \n  }\n\n  return couponList;\n}\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"GetPromotionBalance\");\n$RefreshReg$(_c2, \"GetCouponBalance\");","map":{"version":3,"sources":["/Volumes/Data/BlockchainCourse/FrontEnd/ethcoupon-finalproject-react/src/helper.js"],"names":["Web3","hello","alert","getPromotion","contractInstance","account","Promise","resolve","reject","codeArray","getPastEvents","filter","sponsorAddress","fromBlock","toBlock","error","events","console","log","length","i","push","returnValues","then","getPromotionForCouponHash","hash","couponHash","getRedeem","user","getRedeemCouponInfo","redeems","couponInfo","couponCode","startDate","endDate","amtPerAddress","minRedeemAmt","maxRedeemAmt","targetAddress","GetPromotionBalance","promoCode","methods","checkPromotionalBalance","call","from","result","GetCouponBalance","checkCouponBalance","getPromotionWithBalances","promoList","res","leftOver","unspentEther","getCouponWithBalance","couponList"],"mappings":"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","sourcesContent":["import Web3 from 'web3'\n\nexport function hello(){\n    alert('hello');\n}\n\nexport function getPromotion(contractInstance,account){\n    return new Promise(function(resolve, reject) {\n        var codeArray = [];\n        contractInstance.getPastEvents('Promotion', {\n            filter: {sponsorAddress:account}, // Using an array means OR: e.g. 20 or 23\n            fromBlock: 0,\n            toBlock: 'latest'\n        }, function(error, events){\n          console.log(events);\n          if(events.length > 0){\n            // console.log(events[0].returnValues); \n            for(var i=0;i<events.length;i++){\n              \n              // Get promotional balance for all of them\n              // console.log(events[i].returnValues[\"couponCode\"]);\n              // var res = await GetPromotionBalance(contractInstance,account,events[i].returnValues[\"couponCode\"]);\n              // console.log(\"Balance is \" + res.leftOver);\n              // events[i].returnValues.Balance = res.leftOver;\n              // events[i].returnValues.unspentEther = res.unspentEther;\n              // console.log(events[i].returnValues);\n              codeArray.push(events[i].returnValues);\n              // codeArray.push([events[i].returnValues.couponCode,events[i].returnValues.sponsorAddress,new Date(events[i].returnValues.dateCreated*1000),events[i].returnValues.targetAddress,Web3.utils.fromWei(events[i].returnValues.totalEth,\"ether\"),Web3.utils.fromWei(events[i].returnValues.amtPerAddress,\"ether\"),Web3.utils.fromWei(events[i].returnValues.minRedeemAmt,\"ether\"),Web3.utils.fromWei(events[i].returnValues.maxRedeemAmt,\"ether\"),new Date(events[i].returnValues.startDate*1000),new Date(events[i].returnValues.endDate*1000)]);\n            }\n            resolve(codeArray);            \n          }\n          })\n        .then(function(events){\n        });\n    });\n}\n\nexport function getPromotionForCouponHash(contractInstance,hash){\n  return new Promise(function(resolve, reject) {\n      var codeArray = [];\n      contractInstance.getPastEvents('Promotion', {\n          filter: {couponHash:hash}, // Using an array means OR: e.g. 20 or 23\n          fromBlock: 0,\n          toBlock: 'latest'\n      }, function(error, events){\n        console.log(events);\n        if(events.length > 0){\n          // console.log(events[0].returnValues); \n          // for(var i=0;i<events.length;i++){\n            codeArray.push(events[0].returnValues);\n          // }\n          resolve(codeArray);            \n        }\n        })\n      .then(function(events){\n      });\n  });\n}\n\n\nexport function getRedeem(contractInstance,account){\n    return new Promise(function(resolve, reject) {\n        var codeArray = [];\n        contractInstance.getPastEvents('Redeem', {\n            filter: {user:account}, // Using an array means OR: e.g. 20 or 23\n            fromBlock: 0,\n            toBlock: 'latest'\n        }, function(error, events){\n          console.log(events);\n          if(events.length > 0){\n            // console.log(events[0].returnValues);\n            for(var i=0;i<events.length;i++){\n              codeArray.push(events[i].returnValues);\n            } \n            resolve(codeArray);            \n          }\n          })\n        .then(function(events){\n        });\n    });\n}\n\nexport async function getRedeemCouponInfo(contractInstance,account){\n    // return new Promise(function(resolve, reject) {\n\n      var redeems = await getRedeem(contractInstance,account);\n      for(var i=0;i<redeems.length;i++){\n        var couponInfo = await getPromotionForCouponHash(contractInstance,redeems[i][0]);\n        // append promotion code,target account, starting date, ending date, amount redemmed, min coupon txn amount and max coupon txn amount\n        console.log(couponInfo)\n        if(couponInfo.length > 0){\n          redeems[i][\"couponCode\"] = couponInfo[0].couponCode;\n          redeems[i][\"startDate\"] = couponInfo[0].startDate;\n          redeems[i][\"endDate\"] = couponInfo[0].endDate;\n          redeems[i][\"endDate\"] = couponInfo[0].endDate;\n          redeems[i][\"amtPerAddress\"] = couponInfo[0].amtPerAddress;\n          redeems[i][\"minRedeemAmt\"] = couponInfo[0].minRedeemAmt;\n          redeems[i][\"maxRedeemAmt\"] = couponInfo[0].maxRedeemAmt;\n          redeems[i][\"targetAddress\"] = couponInfo[0].targetAddress;\n        }\n      }\n      return redeems;\n}\n\nexport function GetPromotionBalance(contractInstance,account,promoCode){\n   return new Promise(function(resolve, reject) {\n    // var details = await contractInstance.checkPromotionalBalance.call(promoCode,{from: account});\n    // console.log(details);\n    // // return resolve(details);\n    // return details;\n    contractInstance.methods.checkPromotionalBalance(promoCode).call({from: account})\n    .then(function(result){\n        console.log(result);\n        return(resolve(result));\n    });\n   });\n\n}\n\nexport function GetCouponBalance(contractInstance,account,promoCode){\n  return new Promise(function(resolve, reject) {\n   // var details = await contractInstance.checkPromotionalBalance.call(promoCode,{from: account});\n   // console.log(details);\n   // // return resolve(details);\n   // return details;\n   contractInstance.methods.checkCouponBalance(promoCode).call({from: account})\n   .then(function(result){\n       console.log(result);\n       return(resolve(result));\n   });\n  });\n\n}\n\nexport async function getPromotionWithBalances(contractInstance,account){\n    var promoList = await getPromotion(contractInstance,account);\n    for(var i=0;i<promoList.length;i++){\n      console.log(\"Promotion code is \" + promoList[i][\"couponCode\"]);\n      var res = await GetPromotionBalance(contractInstance,account,promoList[i][\"couponCode\"]);\n      // append promotion code,target account, starting date, ending date, amount redemmed, min coupon txn amount and max coupon txn amount\n      console.log(\"Coupon \" + promoList[i][\"couponCode\"] + \" still has \" + res.leftOver);\n      // if(res.length > 0){\n        promoList[i][\"Balance\"] = res.leftOver;\n        promoList[i][\"unspentEther\"] = res.unspentEther;\n      // }\n      \n    }\n    return promoList;\n}\n\nexport async function getCouponWithBalance(contractInstance,account){\n  var couponList = await getRedeemCouponInfo(contractInstance,account);\n  for(var i=0;i<couponList.length;i++){\n    console.log(\"Coupon code is \" + couponList[i][\"couponCode\"]);\n    var res = await GetCouponBalance(contractInstance,account,couponList[i][\"couponCode\"]);\n    // append promotion code,target account, starting date, ending date, amount redemmed, min coupon txn amount and max coupon txn amount\n    console.log(\"Coupon \" + couponList[i][\"couponCode\"] + \" still has \" + res);\n    // if(res.length > 0){\n      couponList[i][\"Balance\"] = res.leftOver;\n    // }    \n  }\n  return couponList;\n}\n\n"]},"metadata":{},"sourceType":"module"}